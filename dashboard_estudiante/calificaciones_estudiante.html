<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Smart Campus - Calificaciones</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="css/calificaciones_estudiante.css">
</head>
<body>
  <header>
    <img src="images/Smart_Campus_Logo.png" alt="Logo Smart Campus" class="logo">
    <h1>Calificaciones</h1>
  </header>

  <main>
    <section class="bienvenida">
      <h2>¡Bienvenid@ Estudiante!</h2>
      <p>Consulta tus calificaciones por curso en este periodo académico.</p>
    </section>

    <section class="contenedor-calificaciones">
      <!-- Curso 1 -->
      <div class="curso-acordeon">
        <div class="encabezado-acordeon">
          <div class="info-curso">
            <h3>Ingeniería de Requerimientos de Software</h3>
            <p class="codigo-curso">Código: 16-0577</p>
          </div>
          <div class="calificacion-final">
            <span class="porcentaje">0%</span>
            <i class="fas fa-chevron-down icono-desplegar"></i>
          </div>
        </div>
        
        <div class="contenido-acordeon">
          <div class="item-calificacion">
            <span class="nombre-item">Tareas</span>
            <div class="contenedor-valor-reclamo">
              <span class="valor-item" data-valor="0">Pendiente de calificación</span>
              <div class="contenedor-reclamo">
                <i class="fas fa-envelope icono-reclamo" data-curso="Ingeniería de Requerimientos de Software" data-asignacion="Tareas"></i>
                <span class="notificacion-reclamo oculto"><i class="fas fa-circle"></i></span>
              </div>
            </div>
          </div>
          <div class="item-calificacion">
            <span class="nombre-item">Laboratorios</span>
            <div class="contenedor-valor-reclamo">
              <span class="valor-item" data-valor="0">Pendiente de calificación</span>
              <div class="contenedor-reclamo">
                <i class="fas fa-envelope icono-reclamo" data-curso="Ingeniería de Requerimientos de Software" data-asignacion="Laboratorios"></i>
                <span class="notificacion-reclamo oculto"><i class="fas fa-circle"></i></span>
              </div>
            </div>
          </div>
          <div class="item-calificacion">
            <span class="nombre-item">Proyecto Final</span>
            <div class="contenedor-valor-reclamo">
              <span class="valor-item" data-valor="0">Pendiente de calificación</span>
              <div class="contenedor-reclamo">
                <i class="fas fa-envelope icono-reclamo" data-curso="Ingeniería de Requerimientos de Software" data-asignacion="Proyecto Final"></i>
                <span class="notificacion-reclamo oculto"><i class="fas fa-circle"></i></span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Curso 2 -->
      <div class="curso-acordeon">
        <div class="encabezado-acordeon">
          <div class="info-curso">
            <h3>Redes</h3>
            <p class="codigo-curso">Código: 16-0576</p>
          </div>
          <div class="calificacion-final">
            <span class="porcentaje">0%</span>
            <i class="fas fa-chevron-down icono-desplegar"></i>
          </div>
        </div>
        
        <div class="contenido-acordeon">
          <div class="item-calificacion">
            <span class="nombre-item">Tareas</span>
            <div class="contenedor-valor-reclamo">
              <span class="valor-item" data-valor="0">Pendiente de calificación</span>
              <div class="contenedor-reclamo">
                <i class="fas fa-envelope icono-reclamo" data-curso="Redes" data-asignacion="Tareas"></i>
                <span class="notificacion-reclamo oculto"><i class="fas fa-circle"></i></span>
              </div>
            </div>
          </div>
          <div class="item-calificacion">
            <span class="nombre-item">Laboratorios</span>
            <div class="contenedor-valor-reclamo">
              <span class="valor-item" data-valor="0">Pendiente de calificación</span>
              <div class="contenedor-reclamo">
                <i class="fas fa-envelope icono-reclamo" data-curso="Redes" data-asignacion="Laboratorios"></i>
                <span class="notificacion-reclamo oculto"><i class="fas fa-circle"></i></span>
              </div>
            </div>
          </div>
          <div class="item-calificacion">
            <span class="nombre-item">Examen Final</span>
            <div class="contenedor-valor-reclamo">
              <span class="valor-item" data-valor="0">Pendiente de calificación</span>
              <div class="contenedor-reclamo">
                <i class="fas fa-envelope icono-reclamo" data-curso="Redes" data-asignacion="Examen Final"></i>
                <span class="notificacion-reclamo oculto"><i class="fas fa-circle"></i></span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Curso 3 -->
      <div class="curso-acordeon">
        <div class="encabezado-acordeon">
          <div class="info-curso">
            <h3>Bases de Datos</h3>
            <p class="codigo-curso">Código: 16-0582</p>
          </div>
          <div class="calificacion-final">
            <span class="porcentaje">0%</span>
            <i class="fas fa-chevron-down icono-desplegar"></i>
          </div>
        </div>
        
        <div class="contenido-acordeon">
          <div class="item-calificacion">
            <span class="nombre-item">Tareas</span>
            <div class="contenedor-valor-reclamo">
              <span class="valor-item" data-valor="0">Pendiente de calificación</span>
              <div class="contenedor-reclamo">
                <i class="fas fa-envelope icono-reclamo" data-curso="Bases de Datos" data-asignacion="Tareas"></i>
                <span class="notificacion-reclamo oculto"><i class="fas fa-circle"></i></span>
              </div>
            </div>
          </div>
          <div class="item-calificacion">
            <span class="nombre-item">Prácticas</span>
            <div class="contenedor-valor-reclamo">
              <span class="valor-item" data-valor="0">Pendiente de calificación</span>
              <div class="contenedor-reclamo">
                <i class="fas fa-envelope icono-reclamo" data-curso="Bases de Datos" data-asignacion="Prácticas"></i>
                <span class="notificacion-reclamo oculto"><i class="fas fa-circle"></i></span>
              </div>
            </div>
          </div>
          <div class="item-calificacion">
            <span class="nombre-item">Proyecto</span>
            <div class="contenedor-valor-reclamo">
              <span class="valor-item" data-valor="0">Pendiente de calificación</span>
              <div class="contenedor-reclamo">
                <i class="fas fa-envelope icono-reclamo" data-curso="Bases de Datos" data-asignacion="Proyecto"></i>
                <span class="notificacion-reclamo oculto"><i class="fas fa-circle"></i></span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Curso 4 -->
      <div class="curso-acordeon">
        <div class="encabezado-acordeon">
          <div class="info-curso">
            <h3>Argumentación y Retórica</h3>
            <p class="codigo-curso">Código: 03-5001</p>
          </div>
          <div class="calificacion-final">
            <span class="porcentaje">0%</span>
            <i class="fas fa-chevron-down icono-desplegar"></i>
          </div>
        </div>
        
        <div class="contenido-acordeon">
          <div class="item-calificacion">
            <span class="nombre-item">Ensayo</span>
            <div class="contenedor-valor-reclamo">
              <span class="valor-item" data-valor="0">Pendiente de calificación</span>
              <div class="contenedor-reclamo">
                <i class="fas fa-envelope icono-reclamo" data-curso="Argumentación y Retórica" data-asignacion="Ensayo"></i>
                <span class="notificacion-reclamo oculto"><i class="fas fa-circle"></i></span>
              </div>
            </div>
          </div>
          <div class="item-calificacion">
            <span class="nombre-item">Participación</span>
            <div class="contenedor-valor-reclamo">
              <span class="valor-item" data-valor="0">Pendiente de calificación</span>
              <div class="contenedor-reclamo">
                <i class="fas fa-envelope icono-reclamo" data-curso="Argumentación y Retórica" data-asignacion="Participación"></i>
                <span class="notificacion-reclamo oculto"><i class="fas fa-circle"></i></span>
              </div>
            </div>
          </div>
          <div class="item-calificacion">
            <span class="nombre-item">Debate Final</span>
            <div class="contenedor-valor-reclamo">
              <span class="valor-item" data-valor="0">Pendiente de calificación</span>
              <div class="contenedor-reclamo">
                <i class="fas fa-envelope icono-reclamo" data-curso="Argumentación y Retórica" data-asignacion="Debate Final"></i>
                <span class="notificacion-reclamo oculto"><i class="fas fa-circle"></i></span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Curso 5 -->
      <div class="curso-acordeon">
        <div class="encabezado-acordeon">
          <div class="info-curso">
            <h3>Expresiones del Espíritu Humano</h3>
            <p class="codigo-curso">Código: 03-6002</p>
          </div>
          <div class="calificacion-final">
            <span class="porcentaje">0%</span>
            <i class="fas fa-chevron-down icono-desplegar"></i>
          </div>
        </div>
        
        <div class="contenido-acordeon">
          <div class="item-calificacion">
            <span class="nombre-item">Trabajos</span>
            <div class="contenedor-valor-reclamo">
              <span class="valor-item" data-valor="0">Pendiente de calificación</span>
              <div class="contenedor-reclamo">
                <i class="fas fa-envelope icono-reclamo" data-curso="Expresiones del Espíritu Humano" data-asignacion="Trabajos"></i>
                <span class="notificacion-reclamo oculto"><i class="fas fa-circle"></i></span>
              </div>
            </div>
          </div>
          <div class="item-calificacion">
            <span class="nombre-item">Investigación</span>
            <div class="contenedor-valor-reclamo">
              <span class="valor-item" data-valor="0">Pendiente de calificación</span>
              <div class="contenedor-reclamo">
                <i class="fas fa-envelope icono-reclamo" data-curso="Expresiones del Espíritu Humano" data-asignacion="Investigación"></i>
                <span class="notificacion-reclamo oculto"><i class="fas fa-circle"></i></span>
              </div>
            </div>
          </div>
          <div class="item-calificacion">
            <span class="nombre-item">Proyecto Cultural</span>
            <div class="contenedor-valor-reclamo">
              <span class="valor-item" data-valor="0">Pendiente de calificación</span>
              <div class="contenedor-reclamo">
                <i class="fas fa-envelope icono-reclamo" data-curso="Expresiones del Espíritu Humano" data-asignacion="Proyecto Cultural"></i>
                <span class="notificacion-reclamo oculto"><i class="fas fa-circle"></i></span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Modal de reclamo -->
      <div id="modal-reclamo" class="modal">
        <div class="contenido-modal">
          <span class="cerrar-modal">&times;</span>
          <h3>Enviar Reclamo</h3>
          <form id="formulario-reclamo">
            <input type="hidden" id="curso-reclamo" name="curso-reclamo">
            <input type="hidden" id="asignacion-reclamo" name="asignacion-reclamo">
            
            <div class="grupo-formulario">
              <label for="estudiante">Estudiante:</label>
              <input type="text" id="estudiante" name="estudiante" required>
            </div>
            
            <div class="grupo-formulario">
              <label for="destinatario">Destinatario:</label>
              <input type="text" id="destinatario" name="destinatario" required>
            </div>
            
            <div class="grupo-formulario">
              <label for="mensaje">Mensaje:</label>
              <textarea id="mensaje" name="mensaje" rows="5" required></textarea>
            </div>
            
            <button type="submit" class="boton-enviar">Enviar Reclamo</button>
          </form>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <p>&copy; 2025 Smart Campus. Todos los derechos reservados.</p>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Datos de ejemplo para calificaciones (simulando respuesta de API)
      const calificacionesEjemplo = {
        "16-0577": { // Ingeniería de Requerimientos
          "Tareas": 85,
          "Laboratorios": 90,
          "Proyecto Final": 0 // Pendiente
        },
        "16-0576": { // Redes
          "Tareas": 78,
          "Laboratorios": 82,
          "Examen Final": 88
        },
        "16-0582": { // Bases de Datos
          "Tareas": 92,
          "Prácticas": 95,
          "Proyecto": 90
        },
        "03-5001": { // Argumentación y Retórica
          "Ensayo": 0, // Pendiente
          "Participación": 85,
          "Debate Final": 88
        },
        "03-6002": { // Expresiones del Espíritu Humano
          "Trabajos": 90,
          "Investigación": 100,
          "Proyecto Cultural": 0 // Pendiente
        }
      };

      // Actualizar calificaciones con los datos de ejemplo
      function actualizarCalificaciones() {
        const cursos = document.querySelectorAll('.curso-acordeon');
        
        cursos.forEach(curso => {
          const codigo = curso.querySelector('.codigo-curso').textContent.split(': ')[1];
          const calificacionesCurso = calificacionesEjemplo[codigo];
          let suma = 0;
          let contador = 0;
          
          // Actualizar cada item de calificación
          const items = curso.querySelectorAll('.item-calificacion');
          items.forEach(item => {
            const nombreAsignacion = item.querySelector('.nombre-item').textContent;
            const valorItem = item.querySelector('.valor-item');
            const calificacion = calificacionesCurso[nombreAsignacion];
            
            if (calificacion > 0) {
              valorItem.textContent = `${calificacion}%`;
              valorItem.setAttribute('data-valor', calificacion);
              suma += calificacion;
              contador++;
            } else {
              valorItem.textContent = 'Pendiente de calificación';
              valorItem.setAttribute('data-valor', 0);
            }
          });
          
          // Calcular promedio del curso
          const promedio = contador > 0 ? Math.round(suma / contador) : 0;
          curso.querySelector('.porcentaje').textContent = `${promedio}%`;
        });
      }

      // Llamar a la función para actualizar calificaciones al cargar
      actualizarCalificaciones();

      // Manejo de acordeones
      const acordeones = document.querySelectorAll('.curso-acordeon');
      
      acordeones.forEach(acordeon => {
        const encabezado = acordeon.querySelector('.encabezado-acordeon');
        const contenido = acordeon.querySelector('.contenido-acordeon');
        const icono = acordeon.querySelector('.icono-desplegar');
        
        encabezado.addEventListener('click', () => {
          // Cerrar otros acordeones
          acordeones.forEach(item => {
            if (item !== acordeon) {
              item.querySelector('.contenido-acordeon').style.display = 'none';
              item.querySelector('.icono-desplegar').classList.remove('rotado');
            }
          });
          
          // Alternar el acordeon actual
          if (contenido.style.display === 'block') {
            contenido.style.display = 'none';
            icono.classList.remove('rotado');
          } else {
            contenido.style.display = 'block';
            icono.classList.add('rotado');
          }
        });
      });

      // Manejo de reclamos
      const modal = document.getElementById('modal-reclamo');
      const botonesReclamo = document.querySelectorAll('.icono-reclamo');
      const cerrarModal = document.querySelector('.cerrar-modal');
      const formularioReclamo = document.getElementById('formulario-reclamo');
      
      // Abrir modal de reclamo
      botonesReclamo.forEach(boton => {
        boton.addEventListener('click', function() {
          const curso = this.getAttribute('data-curso');
          const asignacion = this.getAttribute('data-asignacion');
          const notificacion = this.nextElementSibling;
          
          // Ocultar notificación al abrir el reclamo
          notificacion.classList.add('oculto');
          
          document.getElementById('curso-reclamo').value = curso;
          document.getElementById('asignacion-reclamo').value = asignacion;
          document.getElementById('destinatario').value = `Profesor de ${curso}`;
          
          modal.style.display = 'block';
        });
      });
      
      // Cerrar modal
      cerrarModal.addEventListener('click', function() {
        modal.style.display = 'none';
      });
      
      // Cerrar modal al hacer clic fuera
      window.addEventListener('click', function(event) {
        if (event.target === modal) {
          modal.style.display = 'none';
        }
      });
      
      // Enviar reclamo (simulado)
      formularioReclamo.addEventListener('submit', function(e) {
        e.preventDefault();
        
        // Aquí iría la lógica para enviar el reclamo al servidor
        const estudiante = document.getElementById('estudiante').value;
        const destinatario = document.getElementById('destinatario').value;
        const mensaje = document.getElementById('mensaje').value;
        const curso = document.getElementById('curso-reclamo').value;
        const asignacion = document.getElementById('asignacion-reclamo').value;
        
        console.log('Reclamo enviado:', {
          estudiante,
          destinatario,
          curso,
          asignacion,
          mensaje
        });
        
        // Simular notificación de respuesta del profesor después de 3 segundos
        setTimeout(() => {
          const iconoReclamo = document.querySelector(`.icono-reclamo[data-curso="${curso}"][data-asignacion="${asignacion}"]`);
          const notificacion = iconoReclamo.nextElementSibling;
          notificacion.classList.remove('oculto');
        }, 3000);
        
        // Limpiar formulario y cerrar modal
        formularioReclamo.reset();
        modal.style.display = 'none';
        alert('Reclamo enviado con éxito. Recibirás una notificación cuando el profesor responda.');
      });
    });
  </script>
</body>
</html>